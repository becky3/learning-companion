# ドキュメント生成・編集スキル

## 概要

プロジェクトドキュメント（仕様書）の新規作成（doc-gen）と既存ドキュメントの更新・修正（doc-edit）を行う 2 つのスキルを定義する。

## 背景

- ドキュメント作成は定型的な構造を持ち、テンプレートやスタイルガイドへの準拠が必要
- Issue/PR/コミット履歴からの情報収集とテンプレート適用をスキル化し、一貫したフォーマットを保証する

## 制約

- 生成・編集後のドキュメントは必ずユーザーがレビューする前提とする
- 既存ファイルへの上書きは警告を表示してから行う
- doc-edit は既存の構造を保持したまま更新する（セクション見出し、リスト形式、テーブル等を壊さない）

## コマンド体系

**doc-gen**:

| コマンド | 用途 |
| --- | --- |
| `/doc-gen spec <feature-name>` | 仕様書を新規作成 |

**doc-edit**:

| コマンド | 用途 |
| --- | --- |
| `/doc-edit <file-path>` | 既存ドキュメントを更新 |
| `/doc-edit <file-path> "更新理由"` | 更新理由を指定して更新 |

## 処理フロー

### doc-gen

```mermaid
flowchart TD
    A[/doc-gen 実行] --> B[引数からドキュメント種別・機能名を判定]
    B --> C[スタイルガイドでカテゴリ決定]
    C --> D[既存ドキュメントを参照しフォーマットを理解]
    D --> E[Issue/PR/コミットから関連情報を収集]
    E --> F[テンプレートに従い仕様書を生成]
    F --> G{既存ファイルあり?}
    G -->|あり| H[上書き警告を表示]
    G -->|なし| I[ファイル保存・結果表示]
    H --> I
```

カテゴリはスタイルガイドのディレクトリ構成に従い、
`features/`・`infrastructure/`・`workflows/`・`agentic/` から選択する。
Issue/PR が見つからない場合は警告を表示し、手動入力で作成を継続する。

### doc-edit

```mermaid
flowchart TD
    A[/doc-edit 実行] --> B[対象ファイルの存在確認]
    B --> C{ファイルあり?}
    C -->|なし| D[エラーメッセージ表示]
    C -->|あり| E[ファイルを読み込み構造を理解]
    E --> F[関連するコード変更を調査]
    F --> G[ドキュメントを更新]
    G --> H[変更差分・サマリーを表示]
```

更新理由が未指定の場合はユーザーに対話的に確認する。

## 入出力

**doc-gen**:

| 項目 | 内容 |
| --- | --- |
| 入力 | ドキュメント種別（`spec`）、機能名 |
| 出力 | `docs/specs/{category}/{feature-name}.md` にファイルを生成。生成結果サマリーを表示 |

Issue/PR が見つからない場合は警告を表示し、手動入力で作成を継続する。

**doc-edit**:

| 項目 | 内容 |
| --- | --- |
| 入力 | ファイルパス、更新理由（任意） |
| 出力 | ファイルを更新。変更前後の差分を表示 |

存在しないファイルパスの場合はエラーメッセージを表示する。
