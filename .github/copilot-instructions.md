# Copilot Code Review Instructions

## レビュー言語

- すべてのレビューコメントは**日本語**で記述してください
- 技術用語（API、HTTP、JSON等）は英語のままで構いません

## レビュー観点

### 1. コード品質

- コードの可読性と保守性
- 未使用のimport、デッドコードの検出
- マジックナンバーの使用
- 適切なエラーハンドリング（`except: pass` の禁止）

### 2. 型安全性

- 型アノテーションが適切に付与されているか
- mypy strict に準拠しているか

### 3. セキュリティ

- OWASP Top 10の観点でのチェック
- コマンドインジェクション、パストラバーサルの可能性
- 機密情報のハードコーディング

### 4. テスト

- テスト名が `test_` プレフィックス + snake_case で振る舞いを表す名前になっているか
- テスト名と実際のテスト内容が一致しているか

### 5. 物語演出の混入チェック（重要）

このプロジェクトでは「エージェントチーム」機能により、キャラクターテーマで開発を進めることがあります。
以下の成果物（PR差分として参照可能なもの）に**キャラクター名、物語の口調、決め台詞、作品固有の表現**が含まれていないかチェックしてください:

- コード内のコメント、docstring（PR差分に含まれるもの）
- PRタイトル・本文
- 変数名、関数名、クラス名

> **Note**: コミットメッセージはCopilot Code Reviewからは参照できないため、別途CI・Gitフック・人手レビューでチェックする運用としています。

**例（検出すべきパターン）:**

- `# 全集中で実装する` → 物語表現
- `def get_breathing_technique()` → 作品固有の表現
- `"""俺は長男だから我慢できる"""` → キャラクターの台詞
- `# ○○風に言うと...` → 作品への言及

**理由:** 物語演出はチーム内コミュニケーション専用であり、プロジェクトの履歴や成果物に混入させるべきではありません。

## コーディング規約（参考情報）

このプロジェクトでは以下のツールでコード品質を担保しています。Copilotレビューでもこれらに準拠しているか確認してください:

- **リンター**: ruff
- **型チェック**: mypy (strict)
- サービスクラスのdocstringに仕様書パス（`仕様: docs/specs/...`）が記載されているか

## レビュースタイル

- 重要な問題に集中し、軽微なスタイルの指摘は控えめに
- 問題の指摘には具体的な改善案を含める
- Critical（バグ・セキュリティ）> Warning（品質）> Suggestion（改善提案）の優先度で指摘
